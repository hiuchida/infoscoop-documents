# 検索サイト管理

検索サイト管理について説明します。

## 1 検索機能について

infoScoop OpenSourceには、2つの検索機能があります。

1. ヘッダー部の検索フォームにキーワードを入力し検索を実行すると、登録された複数の検索サイトに対して同時に検索を実行することができます。
1. RSSリーダー/まとめてRSSリーダーガジェットではRSSのURL毎に登録された検索サイトに対して検索を実行することができます。

この検索サイトの登録を行うのが、検索サイト管理画面です。

管理画面の[__検索フォーム__]を選択すると、検索サイト管理画面が表示されます。
「1」の検索サイトを設定するのが[__検索サイト設定__]で、「2」の検索サイトを設定するのが[__サイト内検索設定__]です。


## 2 画面説明

この項では、検索サイト編集画面で操作可能な各種コントロールについて説明します。


### 2.1 共通アイコン

検索サイト設定およびサイト内検索設定に共通するコントロールを説明します。

<table>
    <thead>
        <tr>
            <th>アイコン</th><th>名前</th><th>説明</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><img src="../../images/add_menu_tree.gif" alt="追加アイコン"></td>
            <td>追加</td>
            <td>
                検索サイト設定/サイト内検索設定に新しい設定を追加します。
            </td>
        </tr>
        <tr>
            <td><img src="../../images/drag.gif" alt="並び替えアイコン"></td>
            <td>並び替え</td>
            <td>
                このアイコンをドラッグ&ドロップすることで上下の順番を入れ替えることができます。
            </td>
        </tr>
        <tr>
            <td><img src="../../images/trash.gif" alt="削除アイコン"></td>
            <td>削除</td>
            <td>
                クリックで該当行の設定を削除します。
            </td>
        </tr>
    </tbody>
</table>


### 2.2 検索サイト設定

各検索サイト毎に以下の項目を設定することができます。

<table>
    <thead>
        <tr>
            <th>設定項目</th><th>説明</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>タイトル</td>
            <td>
                検索結果タブに表示されるタイトルです。タイトルは、最大128文字まで入力可能です。
            </td>
        </tr>
        <tr>
            <td>検索アドレス</td>
            <td>
                検索サイトに対して検索を実行するURLです。置換文字列${KEYWORD}をアドレス内に記述すると、検索実行時にキーワードに置換されます。<br>
                例: 置換文字列を使用した検索アドレス記述<br>
                (検索アドレス)<br>
                http://www.beacon-it.co.jp/cgi-bin/search.cgi?key=${KEYWORD}&key2=${KEYWORD}<br>
                (検索実行時)<br>
                http://www.beacon-it.co.jp/cgi-bin/search.cgi?key=キーワード&key2=キーワード<br>
                置換文字列をアドレス内に記述しなかった場合、URLの末尾にキーワードが付与されて実行されます。<br>
                例: 置換文字列を使用しない検索アドレス記述<br>
                (検索アドレス)<br>
                http://www.beacon-it.co.jp/cgi-bin/search.cgi?key=<br>
                (検索実行時)<br>
                http://www.beacon-it.co.jp/cgi-bin/search.cgi?key=キーワード<br>
                検索アドレスは、最大512文字まで入力可能です。
            </td>
        </tr>
        <tr>
            <td>エンコーディング</td>
            <td>
                検索サイトで使用されるエンコーディングを指定します。指定しない場合はUTF-8で処理されます。<br>
                指定するエンコーディング名は<a href="http://www.iana.org/assignments/character-sets">IANA 文字集合レジストリ(IANA Character Set Registry)</a>を参照ください。<br>
                検証済みのエンコーディングは、「UTF-8」、「Shift_JIS」、「EUC-JP」です。
            </td>
        </tr>
        <tr>
            <td>件数/方法</td>
            <td>
                検索サイトより返される検索結果のHTMLに含まれるヒット件数の取得方法を指定します。以下の2つの方法が指定できます。
                <ul>
                    <li>正規表現: 正規表現によりヒット件数を取得します。1つ目のグループにマッチした値を件数として取得します。(例: 「([0-9]+)件中.*」)</li>
                    <li>ID: ヒット件数が記述されているHTML要素のIDによって取得します。(例: 「resultCount」)</li>
                </ul>
            </td>
        </tr>
        <tr>
            <td>件数/値</td>
            <td>
                方法で正規表現を指定した場合は、正規表現を指定します。<br>
                方法でIDを指定した場合は、HTML要素を特定するIDを指定します。<br>
                <strong>注意</strong> 正規表現はJavaで使用可能な正規表現を記述する必要があります。要素ID/正規表現の値は、最大256文字まで入力可能です。
            </td>
        </tr>
        <tr>
            <td>件数/キャッシュを利用する</td>
            <td>
                検索結果をキャッシュするかどうかを指定します。<br>
                「キャッシュを利用」を有効にすると、件数取得時に検索結果をキャッシュし再利用します。キャッシュを利用する場合パフォーマンスの向上は望めますが、表示が崩れる場合があります。
            </td>
        </tr>
    </tbody>
</table>


### 2.3 サイト内検索設定

サイト内検索は、RSSリーダー/まとめてRSSリーダー固有の機能で、表示しているRSSに対応する検索サイトの設定がある場合に、そのサイトのみを対象にした検索を行うことができる機能です。  
サイト内検索設定で設定可能な項目について説明します。

<table>
    <thead>
        <tr>
            <th>設定項目</th><th>説明</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>RSSパターン</td>
            <td>
                この検索サイトの設定を使用するRSSのURLのパターンを正規表現で指定します。<br>
                RSSのURLがこのパターンにマッチした場合に、検索アドレスに指定した検索サイトに検索を行います。正規表現の判定は、上から順に判定され最初にマッチした設定が適用されます。<br>
                <strong>注意</strong> RSSパターンには、JavaScriptで使用可能な正規表現を記述する必要があります。RSSパターンは、最大512文字まで入力可能です。
            </td>
        </tr>
        <tr>
            <td>検索アドレス</td>
            <td>
                検索サイトに対して検索を実行するURLです。URLの末尾にキーワードが付与されて実行されます。<br>
                例: BeaconITホームページ<br>
                http://www.beacon-it.co.jp/cgi-bin/search.cgi?key=<br>
                サイト内検索に指定する検索アドレスには、前方参照"$n"でマッチしたn番目のグループを参照できます。<br>
                また、空文字を指定した場合は、指定したパターンにマッチするRSSは検索対象外となり、RSSリーダー/まとめてRSSリーダーのヘッダにあるサイト内検索用のアイコンが非表示になります。<br>
                検索アドレスは、最大512文字まで入力可能です。
            </td>
        </tr>
        <tr>
            <td>エンコーディング</td>
            <td>
                検索サイトで使用されるエンコーディングを指定します。指定しない場合はUTF-8で処理されます。<br>
                指定するエンコーディング名は<a href="http://www.iana.org/assignments/character-sets">IANA 文字集合レジストリ(IANA Character Set Registry)</a>を参照ください。<br>
                検証済みのエンコーディングは、「UTF-8」、「Shift_JIS」、「EUC-JP」です。
            </td>
        </tr>
        <tr>
            <td>件数/方法</td>
            <td>
                検索サイトより返される検索結果のHTMLに含まれるヒット件数の取得方法を指定します。以下の2つの方法が指定できます。<br>
                <ul>
                    <li>正規表現: 正規表現によりヒット件数を取得します。1つ目のグループにマッチした値を件数として取得します。(例: 「([0-9]+)件中.*」)</li>
                    <li>ID: ヒット件数が記述されているHTML要素のIDによって取得します。(例: 「resultCount」)</li>
                </ul>
            </td>
        </tr>
        <tr>
            <td>件数/値</td>
            <td>
                方法で正規表現を指定した場合は、正規表現を指定します。<br>
                方法でIDを指定した場合は、HTML要素を特定するIDを指定します。<br>
                <strong>注意</strong> 正規表現はJavaで使用可能な正規表現を記述する必要があります。要素ID/正規表現の値は、最大256文字まで入力可能です。
            </td>
        </tr>
        <tr>
            <td>件数/キャッシュを利用する</td>
            <td>
                検索結果をキャッシュするかどうかを指定します。<br>
                「キャッシュを利用」を有効にすると、件数取得時に検索結果をキャッシュし再利用します。キャッシュを利用する場合パフォーマンスの向上は望めますが、表示が崩れる場合があります。
            </td>
        </tr>
    </tbody>
</table>


### 2.4 検索オプションのデフォルトオプション

検索フォームのデフォルトオプションを設定する項目です。  
ここで設定されたオプションはポータル画面の[__検索オプション__]より再設定することができます。

以下は検索オプションのデフォルト設定についての説明です。

<table>
    <thead>
        <tr>
            <th>設定項目</th><th>説明</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>新しいウィンドウで開く</td>
            <td>
                有効(チェックあり)にした場合、一括検索の結果をポータル内ではなく、別ウィンドウで表示します。
            </td>
        </tr>
    </tbody>
</table>


### 2.5 コンテキストメニュー

検索サイト管理画面のコンテキストメニューについて説明します。

<table>
    <thead>
        <tr>
            <th>アイコン</th><th>名前</th><th>説明</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><img src="../../images/refresh.gif" alt="読み直しアイコン"></td>
            <td>読み直し</td>
            <td>
                今までの編集操作を破棄し、前回の保存状態に戻します。
            </td>
        </tr>
        <tr>
            <td><img src="../../images/apply_changes.gif" alt="変更を保存するアイコン"></td>
            <td>変更を適用する</td>
            <td>
                クリックすると今までに行った編集操作(タブの追加/削除、ロールの追加/編集/削除/移動、コマンドバーの設定、タブの設定)を適用(データを保存します。<br>
                <b>注意</b> 最終的にこのアイコンをクリックしないと、編集操作は破棄されます。
            </td>
        </tr>
    </tbody>
</table>


